package com.fiap.fastfood.external.orm;

import com.amazonaws.services.dynamodbv2.datamodeling.*;
import lombok.Getter;
import org.springframework.data.annotation.Id;

import java.util.Date;

@DynamoDBTable(tableName = "Orquestration")
public class OrquestrationRecordORM {

    @Id
    private OrquestrationRecordId id;
    private String orderId;
    private Date createdAt;

    public OrquestrationRecordORM(String id, String stepId) {
        this.id = new OrquestrationRecordId(id, stepId);
    }

    public OrquestrationRecordORM(String id, String stepId, String orderId) {
        this.id = new OrquestrationRecordId(id, stepId);
        this.orderId = orderId;
    }


    @DynamoDBHashKey(attributeName = "sagaId")
    public String getSagaId() {
        return id != null ? id.getSagaId() : null;
    }

    public void setSagaId(String sagaId) {
        if (id == null) {
            id = new OrquestrationRecordId();
        }

        id.setSagaId(sagaId);
    }

    @DynamoDBRangeKey(attributeName = "stepId")
    public String getStepId() {
        return id != null ? id.getStepId() : null;
    }

    public void setStepId(String stepId) {
        if (id == null) {
            id = new OrquestrationRecordId();
        }
        id.setStepId(stepId);
    }

    @DynamoDBAttribute
    public String getOrderId() {
        return orderId;
    }

    public void setOrderId(String orderId) {
        this.orderId = orderId;
    }

    @DynamoDBAutoGeneratedTimestamp(strategy = DynamoDBAutoGenerateStrategy.CREATE)
    public Date getCreatedAt() {
        return createdAt;
    }

    public void setCreatedAt(Date createdAt) {
        this.createdAt = createdAt;
    }
}
